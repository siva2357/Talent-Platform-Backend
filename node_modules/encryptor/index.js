var crypto = require('crypto');

module.exports = function(key) {
  return {
    encrypt: encrypt,
    decrypt: decrypt
  }

  function encrypt(value) {
    var iv        = crypto.randomBytes(32);
    var cipher    = crypto.createCipher('aes256', key, iv);
    var encrypted = cipher.update(value, 'utf8', 'base64') + cipher.final('base64');

    return encrypted;
  };

  function decrypt(data) {
    var decipher  = crypto.createDecipher('aes256', key);
    var decrypted = decipher.update(data, 'base64', 'utf8') + decipher.final('utf8');

    return decrypted;
  };
}
